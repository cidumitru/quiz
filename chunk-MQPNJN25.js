import{a as F}from"./chunk-CAK3OBX6.js";import{a as X}from"./chunk-3MZ5E4QK.js";import{a as E,b as w,c as I,d as k,f as V,g as B}from"./chunk-3DNGTUDU.js";import{a as P,b as L}from"./chunk-SAODLG2G.js";import"./chunk-VNWETEOL.js";import{c as y,d as S}from"./chunk-NMQYYX3J.js";import{a as K,b as U}from"./chunk-C6WDXVJE.js";import"./chunk-VN3CQEPZ.js";import{b as $,c as H,f as W,i as J}from"./chunk-PXB6PWFU.js";import{b as T,d as h,f as q,g as N,l as R,n as G,o as A,q as j,r as z,s as D,u as Q}from"./chunk-OF6GP2AS.js";import"./chunk-3IDDBSHN.js";import{$b as O,Mb as b,Oa as s,Pa as e,Qa as o,Ra as x,Rb as v,V as d,W as g,Wa as C,Ya as f,_a as p,ma as l,mb as r,ob as _,qa as u,ua as M,ya as c}from"./chunk-WL6JEFOM.js";import"./chunk-WR2VUDLS.js";function Z(n,m){n&1&&(e(0,"mat-error"),r(1," Email is required "),o())}function tt(n,m){n&1&&(e(0,"mat-error"),r(1," Please enter a valid email address "),o())}function et(n,m){n&1&&(e(0,"mat-icon"),r(1,"hourglass_empty"),o())}function it(n,m){if(n&1){let i=C();e(0,"form",8),f("ngSubmit",function(){d(i);let t=p();return g(t.onRequestOtp())}),e(1,"mat-form-field",9)(2,"mat-label"),r(3,"Email"),o(),x(4,"input",10),c(5,Z,2,0,"mat-error",11)(6,tt,2,0,"mat-error",11),o(),e(7,"button",12),c(8,et,2,0,"mat-icon",11),r(9),o()()}if(n&2){let i,a,t=p();s("formGroup",t.emailForm),l(5),s("ngIf",(i=t.emailForm.get("email"))==null?null:i.hasError("required")),l(),s("ngIf",(a=t.emailForm.get("email"))==null?null:a.hasError("email")),l(),s("disabled",!t.emailForm.valid||t.isLoading),l(),s("ngIf",t.isLoading),l(),_(" ",t.isLoading?"Sending...":"Send Verification Code"," ")}}function ot(n,m){n&1&&(e(0,"mat-error"),r(1," Verification code is required "),o())}function nt(n,m){n&1&&(e(0,"mat-error"),r(1," Please enter a valid 6-digit code "),o())}function rt(n,m){n&1&&(e(0,"mat-icon"),r(1,"hourglass_empty"),o())}function at(n,m){if(n&1){let i=C();e(0,"form",8),f("ngSubmit",function(){d(i);let t=p();return g(t.onVerifyOtp())}),e(1,"mat-form-field",9)(2,"mat-label"),r(3,"Verification Code"),o(),x(4,"input",13),c(5,ot,2,0,"mat-error",11)(6,nt,2,0,"mat-error",11),o(),e(7,"button",12),c(8,rt,2,0,"mat-icon",11),r(9),o(),e(10,"div",14)(11,"button",15),f("click",function(){d(i);let t=p();return g(t.onBackToEmail())}),e(12,"mat-icon"),r(13,"arrow_back"),o(),r(14," Back to Email "),o(),e(15,"button",16),f("click",function(){d(i);let t=p();return g(t.onResendOtp())}),e(16,"mat-icon"),r(17,"refresh"),o(),r(18," Resend Code "),o()()()}if(n&2){let i,a,t=p();s("formGroup",t.otpForm),l(5),s("ngIf",(i=t.otpForm.get("code"))==null?null:i.hasError("required")),l(),s("ngIf",(a=t.otpForm.get("code"))==null?null:a.hasError("pattern")),l(),s("disabled",!t.otpForm.valid||t.isLoading),l(),s("ngIf",t.isLoading),l(),_(" ",t.isLoading?"Verifying...":"Verify & Sign In"," "),l(6),s("disabled",t.isLoading)}}var Y=class n{constructor(m,i,a,t){this.fb=m;this.authService=i;this.router=a;this.snackBar=t;this.emailForm=this.fb.group({email:["",[h.required,h.email]]}),this.otpForm=this.fb.group({code:["",[h.required,h.pattern(/^\d{6}$/)]]})}emailForm;otpForm;showOtpForm=!1;isLoading=!1;email="";onRequestOtp(){this.emailForm.valid&&(this.isLoading=!0,this.email=this.emailForm.value.email,this.authService.requestOtp(this.email).subscribe({next:m=>{this.isLoading=!1,this.showOtpForm=!0,this.snackBar.open(m.message,"Close",{duration:5e3})},error:m=>{this.isLoading=!1;let i=m.error?.message||"Failed to send OTP. Please try again.";this.snackBar.open(i,"Close",{duration:5e3})}}))}onVerifyOtp(){if(this.otpForm.valid){this.isLoading=!0;let m=this.otpForm.value.code;this.authService.verifyOtp(this.email,m).subscribe({next:i=>{this.isLoading=!1,this.snackBar.open("Login successful!","Close",{duration:3e3}),this.router.navigate(["/"])},error:i=>{this.isLoading=!1;let a=i.error?.message||"Invalid or expired OTP. Please try again.";this.snackBar.open(a,"Close",{duration:5e3}),this.otpForm.get("code")?.reset()}})}}onBackToEmail(){this.showOtpForm=!1,this.otpForm.reset()}onResendOtp(){this.onRequestOtp()}static \u0275fac=function(i){return new(i||n)(u(D),u(X),u(O),u(F))};static \u0275cmp=M({type:n,selectors:[["app-login"]],decls:17,vars:4,consts:[[1,"login-container"],[1,"logo-section"],["src","logo-light.svg","alt","AQB Logo",1,"login-logo","logo-light"],["src","logo-dark.svg","alt","AQB Logo",1,"login-logo","logo-dark"],[1,"app-title"],[1,"app-subtitle"],[1,"login-card"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","type","email","formControlName","email","placeholder","your@email.com"],[4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"full-width","submit-button",3,"disabled"],["matInput","","type","text","formControlName","code","placeholder","000000","maxlength","6","pattern","[0-9]*"],[1,"otp-actions"],["mat-button","","type","button",3,"click"],["mat-button","","type","button",3,"click","disabled"]],template:function(i,a){i&1&&(e(0,"div",0)(1,"div",1),x(2,"img",2)(3,"img",3),e(4,"h1",4),r(5,"AQB"),o(),e(6,"p",5),r(7,"Aly's Question Bank"),o()(),e(8,"mat-card",6)(9,"mat-card-header")(10,"mat-card-title"),r(11),o(),e(12,"mat-card-subtitle"),r(13),o()(),e(14,"mat-card-content"),c(15,it,10,6,"form",7)(16,at,19,7,"form",7),o()()()),i&2&&(l(11),_(" ",a.showOtpForm?"Enter Verification Code":"Sign In"," "),l(2),_(" ",a.showOtpForm?`We sent a 6-digit code to ${a.email}`:"Enter your email to receive a verification code"," "),l(2),s("ngIf",!a.showOtpForm),l(),s("ngIf",a.showOtpForm))},dependencies:[v,b,Q,R,T,q,N,j,z,G,A,B,E,I,V,k,w,J,W,$,H,U,K,S,y,L,P],styles:[".login-container[_ngcontent-%COMP%]{height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;box-sizing:border-box;gap:32px}.logo-section[_ngcontent-%COMP%]{text-align:center}.logo-section[_ngcontent-%COMP%]   .login-logo[_ngcontent-%COMP%]{width:120px;height:120px;margin-bottom:16px}.logo-section[_ngcontent-%COMP%]   .login-logo.logo-dark[_ngcontent-%COMP%]{display:none}.logo-section[_ngcontent-%COMP%]   .login-logo.logo-light[_ngcontent-%COMP%]{display:block}.logo-section[_ngcontent-%COMP%]   .app-title[_ngcontent-%COMP%]{margin:0 0 4px;font-size:2rem;font-weight:600;color:#1f2937;letter-spacing:2px}.logo-section[_ngcontent-%COMP%]   .app-subtitle[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#6b7280;font-weight:400}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:20px}.full-width[_ngcontent-%COMP%]{width:100%}.submit-button[_ngcontent-%COMP%]{margin-top:20px;height:48px}.submit-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.otp-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:16px}.otp-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}@media (max-width: 768px){.login-container[_ngcontent-%COMP%]{gap:24px;padding:16px}.logo-section[_ngcontent-%COMP%]   .login-logo[_ngcontent-%COMP%]{width:96px;height:96px;margin-bottom:12px}.logo-section[_ngcontent-%COMP%]   .app-title[_ngcontent-%COMP%]{font-size:1.5rem}.logo-section[_ngcontent-%COMP%]   .app-subtitle[_ngcontent-%COMP%]{font-size:.8rem}.login-card[_ngcontent-%COMP%]{padding:16px}}@media (prefers-color-scheme: dark){.logo-section[_ngcontent-%COMP%]   .login-logo.logo-light[_ngcontent-%COMP%]{display:none}.logo-section[_ngcontent-%COMP%]   .login-logo.logo-dark[_ngcontent-%COMP%]{display:block}}"]})};export{Y as LoginComponent};
